# Copilot Instructions for DuckDice Bot

## Project Overview

DuckDice Bot is a professional automation toolkit for DuckDice.io with both desktop (Tkinter) and web (NiceGUI) interfaces. Safety, clarity, and predictability are the highest priorities.

## Core Principles

**Safety first** - User must always be in control
**Predictability** - No surprises, no hidden behavior
**Transparency** - All decisions must be explainable
**Professional** - Serious tool for serious users

---

## 1Ô∏è‚É£ UX / SAFETY RULES

### Safety First

**Critical info always visible:**
- Current balance
- Profit/Loss (session and total)
- Stop conditions (win/loss limits)
- Connection status

**Emergency stop always accessible:**
- Stop button must be visible at all times
- Keyboard shortcut (Ctrl+C, Escape)
- Cannot be hidden behind modals
- Must work even if UI is frozen

### Predictability

**No auto-start:**
- Bot never starts betting automatically
- User must explicitly click "Start"
- Page reload/refresh never resumes betting

**No auto-guessing:**
- Invalid input ‚Üí error message, not silent fix
- Don't assume what user meant
- Don't convert units automatically

**No hidden logic:**
- All calculations visible in logs
- Strategy decisions must be explainable
- No "magic" behavior

### Visual Hierarchy

**Priority order:**
1. **Running status** (most prominent) - Is bot active? Balance? P/L?
2. **Strategy controls** (secondary) - Strategy selector, parameters
3. **Analytics** (tertiary) - Charts, history, statistics

### Color Coding

**Standard color meanings:**
- üü¢ **Green**: Running, profit, success, connected
- üî¥ **Red**: Stopped, loss, error, disconnected
- üü° **Yellow**: Paused, warning, simulation mode
- ‚ö™ **Gray**: Idle, neutral, disabled

### Input Validation

**Block invalid actions:**
- Invalid input must block Start button
- Show clear error message explaining why
- Do not silently fix user input
- Do not proceed with "best guess"

**Explicit units everywhere:**
- "0.001 BTC" not "0.001"
- "50.5%" not "50.5"
- "5 bets" not "5"
- Label every number with its unit

### Real-time UX

**Live updates:**
- Update display every 250ms during betting
- GUI must always remain responsive
- Use threading for background tasks
- Never block the UI thread

**Progress indication:**
- Show bet number (e.g., "Bet 47/100")
- Show time elapsed
- Show estimated time remaining (if applicable)

### Simplicity

**One concept per screen:**
- Don't mix betting controls with analytics
- Use tabs/pages for different purposes
- Don't overwhelm with too many options

**No duplicate controls:**
- One way to start/stop
- One place for each setting
- Avoid redundant buttons

**No modal spam:**
- Use modals sparingly
- Never block user for non-critical info
- Use inline messages when possible

### Data Transparency

**All decisions explainable:**
- Log why each bet amount was chosen
- Show formula/calculation
- Link decisions to strategy rules

**Logs are first-class citizens:**
- Always visible or easily accessible
- Timestamped and detailed
- Exportable
- Never truncated without warning

### Professional Tone

**No gamification:**
- No "streaks", "achievements", "levels"
- No celebratory animations
- No sound effects (optional notification sounds OK)

**Neutral wording:**
- "Profit/Loss" not "Winnings"
- "Stop" not "Quit" or "Give Up"
- "Strategy" not "System" or "Method"
- Technical and factual

### Failure Modes

**Crash-safe:**
- Bet history saved immediately to disk
- Session recoverable after crash
- Settings persisted automatically

**Network failure:**
- Pause betting immediately
- Show clear notification
- Don't retry automatically
- Let user decide when to resume

### Defaults

**Conservative defaults for first run:**
- Small bet amounts
- Reasonable win/loss limits
- Safe strategy (e.g., Flat Betting)
- Simulation mode enabled

---

## 2Ô∏è‚É£ STYLE / LAYOUT RULES

### Theme

**Dark mode default:**
- Dark background (#1a1a1a, #2a2a2a)
- Light text (#e0e0e0, #f0f0f0)
- Accent colors for status (green/red/yellow)
- High contrast for readability

### Controls

**Large, clear buttons:**
- Minimum 40px height for clickable elements
- Clear labels (no icons-only buttons)
- Sufficient spacing between elements
- Touch-friendly for tablets

### Responsive Design

**Mobile-friendly / responsive layout:**
- Works on desktop, tablet, and mobile
- Adapts to different screen sizes
- Important info visible without scrolling
- No horizontal scroll

### Updates

**Deterministic live updates:**
- Update cycle is predictable
- No random delays
- Consistent refresh intervals
- Smooth, not jarring

### Charts

**Charts must not block bot:**
- Charts run in separate thread
- Never delay bet execution
- Degrade gracefully (skip frame if needed)
- Can be disabled entirely

### Tooltips

**Tooltips for strategy parameters:**
- Explain what each parameter does
- Show examples
- Include recommended ranges
- Don't require external documentation

---

## 3Ô∏è‚É£ ENTRY POINT

### Web Interface (NiceGUI)

**Launch command:**
```bash
python app/main.py  # Opens http://localhost:8080
```

**Initial state:**
- All screens available via tabs
- Start button **disabled** until:
  - Valid API key entered
  - Strategy selected
  - Parameters validated
- Clear message explaining why Start is disabled

### Desktop GUI (Tkinter)

**Launch command:**
```bash
python duckdice_gui_ultimate.py
```

**Same initial state rules apply**

---

## 4Ô∏è‚É£ FINAL COPILOT RULES

### Implementation Quality

**All features must be implemented:**
- No placeholder UI ("Coming Soon")
- No TODOs in production code
- All buttons must work
- All features must be tested

### Code Organization

**If output too long ‚Üí split into files:**
- Separate concerns into modules
- Don't create monolithic files
- Use clear file/module names
- Follow project structure

### Documentation

**Use comments for explanation only:**
- Explain *why*, not *what*
- Complex algorithms need comments
- Public APIs need docstrings
- No obvious comments ("increment counter")

### Priorities

**Prioritize safety and control:**
1. User safety (can't lose more than intended)
2. User control (can stop anytime)
3. Clarity (understands what's happening)
4. Features (only if above are satisfied)

### Code Quality

**Reactive, modular, maintainable code:**
- Use reactive patterns (observers, events)
- Small, focused functions
- Clear separation of concerns
- Easy to test and debug

---

## 5Ô∏è‚É£ ARCHITECTURE PATTERNS

### State Management

**Single source of truth:**
- One state object for app state
- Components react to state changes
- State changes are logged
- State is serializable

### Error Handling

**Fail gracefully:**
- Catch all exceptions
- Log errors with context
- Show user-friendly messages
- Never crash silently

### API Calls

**Resilient API usage:**
- Retry with exponential backoff
- Timeout on all requests
- Handle rate limiting
- Log all API calls

### Threading

**Safe threading:**
- UI updates only on main thread
- Background work in separate threads
- Use thread-safe queues
- Proper thread cleanup

---

## 6Ô∏è‚É£ TESTING EXPECTATIONS

### Before Submitting Code

**Must be tested:**
- Manual testing with real scenarios
- Edge cases handled
- Error paths work
- UI is responsive

### Simulation Mode

**Always test in simulation first:**
- No real money at risk
- Same code path as live
- Clearly marked as simulation
- Easy to toggle

---

## 7Ô∏è‚É£ STRATEGY IMPLEMENTATION

### Strategy Interface

**All strategies implement:**
```python
def calculate_next_bet(self, last_bet, won, balance) -> float:
    """Calculate next bet amount."""
```

### Strategy Metadata

**Required metadata:**
- Name (clear, descriptive)
- Description (what it does)
- Risk level (Low/Medium/High/Extreme)
- Recommended parameters
- Example behavior

### Strategy Parameters

**User-configurable:**
- Validated ranges
- Clear labels and units
- Tooltips explaining each
- Sensible defaults

---

## 8Ô∏è‚É£ LOGGING REQUIREMENTS

### What to Log

**Always log:**
- Every bet (amount, target, result)
- Strategy decisions
- Balance changes
- Errors and warnings
- Start/stop events

### Log Format

**Structured logging:**
- Timestamp (ISO 8601)
- Log level (INFO, WARNING, ERROR)
- Context (what was happening)
- Data (relevant values)

### Log Storage

**Persistent logs:**
- Saved to disk immediately
- JSONL format (one JSON object per line)
- Rotation (don't fill disk)
- Exportable

---

## 9Ô∏è‚É£ PERFORMANCE RULES

### Response Time

**UI must be snappy:**
- Button click ‚Üí feedback < 100ms
- Page load < 1 second
- Chart update < 250ms
- Bet execution < 500ms (excluding API)

### Resource Usage

**Efficient resource use:**
- No memory leaks
- CPU usage reasonable
- Network usage minimal
- Disk I/O batched

---

## üîü ACCESSIBILITY

### Keyboard Navigation

**Full keyboard support:**
- Tab through all controls
- Shortcuts for common actions
- Focus indicators visible
- Logical tab order

### Screen Readers

**Accessible to screen readers:**
- Semantic HTML (web interface)
- Alt text for images
- ARIA labels where needed
- Proper heading hierarchy

---

## Summary

**Remember: Safety, clarity, and predictability take priority over beauty or cleverness.**

If in doubt:
1. ‚úÖ Is it safe?
2. ‚úÖ Is it clear?
3. ‚úÖ Is it predictable?
4. ‚úÖ Does it help the user stay in control?

If all four are "yes", proceed. Otherwise, reconsider.
